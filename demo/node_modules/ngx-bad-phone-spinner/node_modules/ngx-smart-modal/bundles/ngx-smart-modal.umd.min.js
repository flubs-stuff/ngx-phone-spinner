!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common"],factory):factory((global.ng=global.ng||{},global.ng.ngxSmartModal={}),global.ng.core,global.ng.common)}(this,function(exports,core,common){"use strict";/**
 * @license ngx-smart-modal
 * MIT license
 */
var NgxSmartModalConfig={bodyClassOpen:"dialog-open",prefixEvent:"ngx-smart-modal."},NgxSmartModalComponent=function(){function NgxSmartModalComponent(_renderer,_changeDetectorRef){this._renderer=_renderer,this._changeDetectorRef=_changeDetectorRef,this.closable=!0,this.escapable=!0,this.dismissable=!0,this.identifier="",this.customClass="nsm-dialog-animation-fade",this.visible=!1,this.backdrop=!0,this.force=!0,this.hideDelay=500,this.autostart=!1,this.target="",this.visibleChange=new core.EventEmitter,this.onClose=new core.EventEmitter,this.onCloseFinished=new core.EventEmitter,this.onDismiss=new core.EventEmitter,this.onDismissFinished=new core.EventEmitter,this.onAnyCloseEvent=new core.EventEmitter,this.onAnyCloseEventFinished=new core.EventEmitter,this.onOpen=new core.EventEmitter,this.onOpenFinished=new core.EventEmitter,this.onEscape=new core.EventEmitter,this.onDataAdded=new core.EventEmitter,this.onDataRemoved=new core.EventEmitter,this.layerPosition=1041,this.overlayVisible=!1,this.openedClass=!1,this.createFrom="html"}return NgxSmartModalComponent.prototype.ngOnInit=function(){if(!this.identifier||!this.identifier.length)throw new Error("identifier field isn’t set. Please set one before calling <ngx-smart-modal> in a template.");this._sendEvent("create")},NgxSmartModalComponent.prototype.ngOnDestroy=function(){this._sendEvent("delete")},NgxSmartModalComponent.prototype.open=function(top){return this._sendEvent("open",{top:top}),this},NgxSmartModalComponent.prototype.close=function(){return this._sendEvent("close"),this},NgxSmartModalComponent.prototype.dismiss=function(e){return this.dismissable&&e.target.classList.contains("overlay")?(this._sendEvent("dismiss"),this):this},NgxSmartModalComponent.prototype.toggle=function(top){return this._sendEvent("toggle",{top:top}),this},NgxSmartModalComponent.prototype.addCustomClass=function(className){return this.customClass.length?this.customClass+=" "+className:this.customClass=className,this},NgxSmartModalComponent.prototype.removeCustomClass=function(className){return this.customClass=className?this.customClass.replace(className,"").trim():"",this},NgxSmartModalComponent.prototype.isVisible=function(){return this.visible},NgxSmartModalComponent.prototype.hasData=function(){return void 0!==this._data},NgxSmartModalComponent.prototype.setData=function(data,force){return(!this.hasData()||this.hasData()&&force)&&(this._data=data,this.onDataAdded.emit(this._data),this.markForCheck()),this},NgxSmartModalComponent.prototype.getData=function(){return this._data},NgxSmartModalComponent.prototype.removeData=function(){return this._data=void 0,this.onDataRemoved.emit(!0),this.markForCheck(),this},NgxSmartModalComponent.prototype.addBodyClass=function(){return this._renderer.addClass(document.body,NgxSmartModalConfig.bodyClassOpen),this},NgxSmartModalComponent.prototype.removeBodyClass=function(){return this._renderer.removeClass(document.body,NgxSmartModalConfig.bodyClassOpen),this},NgxSmartModalComponent.prototype.markForCheck=function(){try{this._changeDetectorRef.detectChanges()}catch(e){}this._changeDetectorRef.markForCheck()},NgxSmartModalComponent.prototype.targetPlacement=function(){if(!(this.nsmDialog.length&&this.nsmContent.length&&this.nsmOverlay.length&&this.target))return!1;var targetElement=document.querySelector(this.target);if(!targetElement)return!1;var targetElementRect=targetElement.getBoundingClientRect(),bodyRect=this.nsmOverlay.first.nativeElement.getBoundingClientRect(),nsmContentRect=this.nsmContent.first.nativeElement.getBoundingClientRect(),nsmDialogRect=this.nsmDialog.first.nativeElement.getBoundingClientRect(),marginLeft=parseInt(getComputedStyle(this.nsmContent.first.nativeElement).marginLeft,10),marginTop=parseInt(getComputedStyle(this.nsmContent.first.nativeElement).marginTop,10),offsetTop=targetElementRect.top-nsmDialogRect.top-(nsmContentRect.height-targetElementRect.height)/2,offsetLeft=targetElementRect.left-nsmDialogRect.left-(nsmContentRect.width-targetElementRect.width)/2;offsetLeft+nsmDialogRect.left+nsmContentRect.width+2*marginLeft>bodyRect.width?offsetLeft=bodyRect.width-(nsmDialogRect.left+nsmContentRect.width)-2*marginLeft:offsetLeft+nsmDialogRect.left<0&&(offsetLeft=-nsmDialogRect.left),offsetTop+nsmDialogRect.top+nsmContentRect.height+marginTop>bodyRect.height&&(offsetTop=bodyRect.height-(nsmDialogRect.top+nsmContentRect.height)-marginTop),this._renderer.setStyle(this.nsmContent.first.nativeElement,"top",(offsetTop<0?0:offsetTop)+"px"),this._renderer.setStyle(this.nsmContent.first.nativeElement,"left",offsetLeft+"px")},NgxSmartModalComponent.prototype._sendEvent=function(name,extraData){var data={extraData:extraData,instance:{id:this.identifier,modal:this}},event=new CustomEvent(NgxSmartModalConfig.prefixEvent+name,{detail:data});window.dispatchEvent(event)},NgxSmartModalComponent.decorators=[{type:core.Component,args:[{selector:"ngx-smart-modal",template:'\n    <div *ngIf="overlayVisible"\n         [style.z-index]="visible ? layerPosition-1 : -1"\n         [ngClass]="{\'transparent\':!backdrop, \'overlay\':true, \'nsm-overlay-open\':openedClass}"\n         (mousedown)="dismiss($event)" #nsmOverlay>\n      <div [style.z-index]="visible ? layerPosition : -1"\n           [ngClass]="[\'nsm-dialog\', customClass, openedClass ? \'nsm-dialog-open\': \'nsm-dialog-close\']" #nsmDialog>\n        <div class="nsm-content" #nsmContent>\n          <div class="nsm-body">\n            <ng-content></ng-content>\n          </div>\n          <button type="button" *ngIf="closable" (click)="close()" aria-label="Close" class="nsm-dialog-btn-close">\n            <img\n              src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCI+CjxnPgoJPGc+CgkJPHBhdGggZD0iTTUwNS45NDMsNi4wNThjLTguMDc3LTguMDc3LTIxLjE3Mi04LjA3Ny0yOS4yNDksMEw2LjA1OCw0NzYuNjkzYy04LjA3Nyw4LjA3Ny04LjA3NywyMS4xNzIsMCwyOS4yNDkgICAgQzEwLjA5Niw1MDkuOTgyLDE1LjM5LDUxMiwyMC42ODMsNTEyYzUuMjkzLDAsMTAuNTg2LTIuMDE5LDE0LjYyNS02LjA1OUw1MDUuOTQzLDM1LjMwNiAgICBDNTE0LjAxOSwyNy4yMyw1MTQuMDE5LDE0LjEzNSw1MDUuOTQzLDYuMDU4eiIgZmlsbD0iIzAwMDAwMCIvPgoJPC9nPgo8L2c+CjxnPgoJPGc+CgkJPHBhdGggZD0iTTUwNS45NDIsNDc2LjY5NEwzNS4zMDYsNi4wNTljLTguMDc2LTguMDc3LTIxLjE3Mi04LjA3Ny0yOS4yNDgsMGMtOC4wNzcsOC4wNzYtOC4wNzcsMjEuMTcxLDAsMjkuMjQ4bDQ3MC42MzYsNDcwLjYzNiAgICBjNC4wMzgsNC4wMzksOS4zMzIsNi4wNTgsMTQuNjI1LDYuMDU4YzUuMjkzLDAsMTAuNTg3LTIuMDE5LDE0LjYyNC02LjA1N0M1MTQuMDE4LDQ5Ny44NjYsNTE0LjAxOCw0ODQuNzcxLDUwNS45NDIsNDc2LjY5NHoiIGZpbGw9IiMwMDAwMDAiLz4KCTwvZz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K" />\n          </button>\n        </div>\n      </div>\n    </div>\n  '}]}],NgxSmartModalComponent.ctorParameters=function(){return[{type:core.Renderer2},{type:core.ChangeDetectorRef}]},NgxSmartModalComponent.propDecorators={closable:[{type:core.Input}],escapable:[{type:core.Input}],dismissable:[{type:core.Input}],identifier:[{type:core.Input}],customClass:[{type:core.Input}],visible:[{type:core.Input}],backdrop:[{type:core.Input}],force:[{type:core.Input}],hideDelay:[{type:core.Input}],autostart:[{type:core.Input}],target:[{type:core.Input}],visibleChange:[{type:core.Output}],onClose:[{type:core.Output}],onCloseFinished:[{type:core.Output}],onDismiss:[{type:core.Output}],onDismissFinished:[{type:core.Output}],onAnyCloseEvent:[{type:core.Output}],onAnyCloseEventFinished:[{type:core.Output}],onOpen:[{type:core.Output}],onOpenFinished:[{type:core.Output}],onEscape:[{type:core.Output}],onDataAdded:[{type:core.Output}],onDataRemoved:[{type:core.Output}],nsmContent:[{type:core.ViewChildren,args:["nsmContent"]}],nsmDialog:[{type:core.ViewChildren,args:["nsmDialog"]}],nsmOverlay:[{type:core.ViewChildren,args:["nsmOverlay"]}],targetPlacement:[{type:core.HostListener,args:["window:resize"]}]},NgxSmartModalComponent}(),NgxSmartModalStackService=function(){function NgxSmartModalStackService(){this._modalStack=[]}return NgxSmartModalStackService.prototype.addModal=function(modalInstance,force){if(force){var i=this._modalStack.findIndex(function(o){return o.id===modalInstance.id});i>-1?this._modalStack[i].modal=modalInstance.modal:this._modalStack.push(modalInstance)}else this._modalStack.push(modalInstance)},NgxSmartModalStackService.prototype.getModal=function(id){var i=this._modalStack.find(function(o){return o.id===id});if(void 0!==i)return i.modal;throw new Error("Cannot find modal with identifier "+id)},NgxSmartModalStackService.prototype.getModalStack=function(){return this._modalStack},NgxSmartModalStackService.prototype.getOpenedModals=function(){return this._modalStack.filter(function(o){return o.modal.visible})},NgxSmartModalStackService.prototype.getTopOpenedModal=function(){if(!this.getOpenedModals().length)throw new Error("No modal is opened");return this.getOpenedModals().map(function(o){return o.modal}).reduce(function(highest,item){return item.layerPosition>highest.layerPosition?item:highest},this.getOpenedModals()[0].modal)},NgxSmartModalStackService.prototype.getHigherIndex=function(){return Math.max.apply(Math,this._modalStack.map(function(o){return o.modal.layerPosition}).concat([1041]))+1},NgxSmartModalStackService.prototype.getModalStackCount=function(){return this._modalStack.length},NgxSmartModalStackService.prototype.removeModal=function(id){var i=this._modalStack.findIndex(function(o){return o.id===id});i>-1&&this._modalStack.splice(i,1)},NgxSmartModalStackService.decorators=[{type:core.Injectable}],NgxSmartModalStackService.ctorParameters=function(){return[]},NgxSmartModalStackService}(),NgxSmartModalService=function(){function NgxSmartModalService(_componentFactoryResolver,_appRef,_injector,_document,_modalStack){var _this=this;this._componentFactoryResolver=_componentFactoryResolver,this._appRef=_appRef,this._injector=_injector,this._document=_document,this._modalStack=_modalStack,this._escapeKeyboardEvent=function(event){if(27===event.keyCode)try{var modal=_this.getTopOpenedModal();return!!modal.escapable&&(modal.onEscape.emit(modal),_this.closeLatestModal(),!0)}catch(e){return!1}return!1},this._addEvents()}return NgxSmartModalService.prototype.addModal=function(modalInstance,force){this._modalStack.addModal(modalInstance,force)},NgxSmartModalService.prototype.getModal=function(id){return this._modalStack.getModal(id)},NgxSmartModalService.prototype.get=function(id){return this.getModal(id)},NgxSmartModalService.prototype.open=function(id,force){return void 0===force&&(force=!1),this._openModal(this.get(id),force)},NgxSmartModalService.prototype.close=function(id){return this._closeModal(this.get(id))},NgxSmartModalService.prototype.toggle=function(id,force){return void 0===force&&(force=!1),this._toggleModal(this.get(id),force)},NgxSmartModalService.prototype.getModalStack=function(){return this._modalStack.getModalStack()},NgxSmartModalService.prototype.getOpenedModals=function(){return this._modalStack.getOpenedModals()},NgxSmartModalService.prototype.getTopOpenedModal=function(){return this._modalStack.getTopOpenedModal()},NgxSmartModalService.prototype.getHigherIndex=function(){return this._modalStack.getHigherIndex()},NgxSmartModalService.prototype.getModalStackCount=function(){return this._modalStack.getModalStackCount()},NgxSmartModalService.prototype.removeModal=function(id){this._modalStack.removeModal(id)},NgxSmartModalService.prototype.setModalData=function(data,id,force){var i;return!!(i=this.get(id))&&(i.setData(data,force),!0)},NgxSmartModalService.prototype.getModalData=function(id){var i;return(i=this.get(id))?i.getData():null},NgxSmartModalService.prototype.resetModalData=function(id){if(this._modalStack.getModalStack().find(function(o){return o.id===id})){var removed=this.getModal(id).getData();return this.getModal(id).removeData(),removed}return!1},NgxSmartModalService.prototype.closeLatestModal=function(){this.getTopOpenedModal().close()},NgxSmartModalService.prototype.create=function(id,content,options){void 0===options&&(options={});try{return this.getModal(id)}catch(e){var componentFactory=this._componentFactoryResolver.resolveComponentFactory(NgxSmartModalComponent),ngContent=this._resolveNgContent(content),componentRef=componentFactory.create(this._injector,ngContent);componentRef.instance.identifier=id,componentRef.instance.createFrom="service","boolean"==typeof options.closable&&(componentRef.instance.closable=options.closable),"boolean"==typeof options.escapable&&(componentRef.instance.escapable=options.escapable),"boolean"==typeof options.dismissable&&(componentRef.instance.dismissable=options.dismissable),"string"==typeof options.customClass&&(componentRef.instance.customClass=options.customClass),"boolean"==typeof options.backdrop&&(componentRef.instance.backdrop=options.backdrop),"boolean"==typeof options.force&&(componentRef.instance.force=options.force),"number"==typeof options.hideDelay&&(componentRef.instance.hideDelay=options.hideDelay),"boolean"==typeof options.autostart&&(componentRef.instance.autostart=options.autostart),"string"==typeof options.target&&(componentRef.instance.target=options.target),this._appRef.attachView(componentRef.hostView);var domElem=componentRef.hostView.rootNodes[0];return document.body.appendChild(domElem),componentRef.instance}},NgxSmartModalService.prototype._addEvents=function(){var _this=this;window.addEventListener(NgxSmartModalConfig.prefixEvent+"create",function(e){_this._initModal(e.detail.instance)}),window.addEventListener(NgxSmartModalConfig.prefixEvent+"delete",function(e){_this._deleteModal(e.detail.instance)}),window.addEventListener(NgxSmartModalConfig.prefixEvent+"open",function(e){_this._openModal(e.detail.instance.modal,e.detail.top)}),window.addEventListener(NgxSmartModalConfig.prefixEvent+"toggle",function(e){_this._toggleModal(e.detail.instance.modal,e.detail.top)}),window.addEventListener(NgxSmartModalConfig.prefixEvent+"close",function(e){_this._closeModal(e.detail.instance.modal)}),window.addEventListener(NgxSmartModalConfig.prefixEvent+"dismiss",function(e){_this._dismissModal(e.detail.instance.modal)}),window.addEventListener("keyup",this._escapeKeyboardEvent)},NgxSmartModalService.prototype._initModal=function(modalInstance){modalInstance.modal.layerPosition+=this.getModalStackCount(),this.addModal(modalInstance,modalInstance.modal.force),modalInstance.modal.autostart&&this.open(modalInstance.id)},NgxSmartModalService.prototype._openModal=function(modal,top){return!modal.visible&&(top&&(modal.layerPosition=this.getHigherIndex()),modal.addBodyClass(),modal.overlayVisible=!0,modal.visible=!0,modal.onOpen.emit(modal),modal.markForCheck(),setTimeout(function(){modal.openedClass=!0,modal.target&&modal.targetPlacement(),modal.markForCheck(),modal.onOpenFinished.emit(modal)}),!0)},NgxSmartModalService.prototype._toggleModal=function(modal,top){return modal.visible?this._closeModal(modal):this._openModal(modal,top)},NgxSmartModalService.prototype._closeModal=function(modal){return!!modal.openedClass&&(modal.openedClass=!1,modal.onClose.emit(modal),modal.onAnyCloseEvent.emit(modal),this.getOpenedModals().length<2&&modal.removeBodyClass(),setTimeout(function(){modal.visibleChange.emit(modal.visible),modal.visible=!1,modal.overlayVisible=!1,modal.markForCheck(),modal.onCloseFinished.emit(modal),modal.onAnyCloseEventFinished.emit(modal)},modal.hideDelay),!0)},NgxSmartModalService.prototype._dismissModal=function(modal){return!!modal.openedClass&&(modal.openedClass=!1,modal.onDismiss.emit(modal),modal.onAnyCloseEvent.emit(modal),this.getOpenedModals().length<2&&modal.removeBodyClass(),setTimeout(function(){modal.visible=!1,modal.visibleChange.emit(modal.visible),modal.overlayVisible=!1,modal.markForCheck(),modal.onDismissFinished.emit(modal),modal.onAnyCloseEventFinished.emit(modal)},modal.hideDelay),!0)},NgxSmartModalService.prototype._deleteModal=function(modalInstance){this.removeModal(modalInstance.id),this.getModalStack().length||modalInstance.modal.removeBodyClass()},NgxSmartModalService.prototype._resolveNgContent=function(content){return"string"==typeof content?[[this._document.createTextNode(content)]]:content instanceof core.TemplateRef?[content.createEmbeddedView(null).rootNodes]:[[this._componentFactoryResolver.resolveComponentFactory(content).create(this._injector).location.nativeElement],[this._document.createTextNode("")]]},NgxSmartModalService.decorators=[{type:core.Injectable}],NgxSmartModalService.ctorParameters=function(){return[{type:core.ComponentFactoryResolver},{type:core.ApplicationRef},{type:core.Injector},{type:void 0,decorators:[{type:core.Inject,args:[common.DOCUMENT]}]},{type:NgxSmartModalStackService}]},NgxSmartModalService}(),NgxSmartModalModule=function(){function NgxSmartModalModule(serivce){this.serivce=serivce}return NgxSmartModalModule.forRoot=function(){return{ngModule:NgxSmartModalModule,providers:[NgxSmartModalService,NgxSmartModalStackService]}},NgxSmartModalModule.forChild=function(){return{ngModule:NgxSmartModalModule,providers:[NgxSmartModalService,NgxSmartModalStackService]}},NgxSmartModalModule.decorators=[{type:core.NgModule,args:[{declarations:[NgxSmartModalComponent],entryComponents:[NgxSmartModalComponent],exports:[NgxSmartModalComponent],imports:[common.CommonModule]}]}],NgxSmartModalModule.ctorParameters=function(){return[{type:NgxSmartModalService}]},NgxSmartModalModule}();exports.NgxSmartModalService=NgxSmartModalService,exports.NgxSmartModalComponent=NgxSmartModalComponent,exports.NgxSmartModalModule=NgxSmartModalModule,exports.NgxSmartModalConfig=NgxSmartModalConfig,exports.ɵa=NgxSmartModalStackService,Object.defineProperty(exports,"__esModule",{value:!0})});